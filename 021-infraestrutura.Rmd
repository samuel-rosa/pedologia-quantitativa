<!-- # PARTE II -- INFRAESTRUTURA TECNOL√ìGICA {-} -->

<!-- # Hardware -->

# Programas de Computador

**Aten√ß√£o!** Este cap√≠tulo est√° em fase de *desenvolvimento*. Visite a [p√°gina do projeto][issues] se voc√™ tiver alguma sugest√£o, d√∫vida ou estiver disposto a colaborar. Sua opini√£o/ajuda √© muito importante!

[issues]: https://github.com/samuel-rosa/pedologia-quantitativa/issues

## Introdu√ß√£o

<!-- Conforme vimos no cap√≠tulo anterior,  -->
A aplica√ß√£o de m√©todos quantitativos -- matem√°ticos e estat√≠sticos -- para o estudo da distribui√ß√£o e g√™nese do solo se d√°, fundamentalmente, pelo uso de computadores. Isso significa que necessitamos, obrigatoriamente, de programas de computador -- *software* -- especializados para tal tarefa. √â por meio desses programa de computador que daremos instru√ß√µes ao nosso computador para que ele desempenhe determinada tarefa quantitativa como, por exemplo, computar estat√≠sticas descritivas de um conjunto de dados do solo ou produzir um gr√°fico relacionando uma vari√°vel dependente $y$ com uma vari√°vel independente $x$.

Os programas de computador dispon√≠veis para o desenvolvimento de estudos quantitativos s√£o in√∫meros e diversos -- fruto da diversidade de m√©todos quantitativos hoje existentes --, sendo geralmente necess√°rio usar dois ou mais programa de computador para desenvolver qualquer estudo pedom√©trico -- por mais simples que o estudo seja. Para aprender e potencialmente dominar o uso de qualquer programa de computador com aplica√ß√£o pedom√©trica, possivelmente alguns dos quais ainda lhe s√£o desconhecidos at√© ent√£o, ser√° necess√°rio que voc√™ aprenda a sua 'linguagem'. Como sabemos, uma [linguagem][linguagem] √© um sistema de signos -- s√≠mbolos ou palavras -- convencionados que serve para a comunica√ß√£o de conceitos, ideias, significados, pensamentos. Assim, a linguagem de um programa de computador qualquer ser√°, tamb√©m, um sistema de signos convencionados, mas que serve para a nossa comunica√ß√£o com o computador.

[linguagem]: https://pt.wikipedia.org/wiki/Linguagem

A linguagem usada por um programa de computador geralmente √© um tanto quanto complicada quando comparada √† linguagem que n√≥s, seres humanos, usamos para nos comunicar entre n√≥s mesmos no dia a dia. Isso √© tanto mais verdade quanto mais distante das chamadas Ci√™ncias Exatas for a nossa forma√ß√£o -- como √© o meu caso. √â por isso que os programas de computador mais populares, que voc√™ provavelmente j√° usa, s√£o aqueles que possuem o que chamamos de interface gr√°fica do usu√°rio ([GUI][gui], do ingl√™s *graphical user interface*). Essa interface nada mais √©, como o pr√≥prio nome j√° diz, uma camada sobreposta √† linguagem usada pelo programa de computador, uma camada intermedi√°ria entre a linguagem e o usu√°rio, cuja fun√ß√£o √© tornar o programa de computador mais amig√°vel para uso. Assim, a comunica√ß√£o do usu√°rio se d√°, primeiro, via emiss√£o de comandos pressionando bot√µes e √≠cones ou escolhendo itens em caixas de di√°logo, usando tanto o *mouse* como o teclado.

[gui]: https://pt.wikipedia.org/wiki/Interface_gr%C3%A1fica_do_utilizador

Apesar da amigabilidade dos programas de computador que usam uma interface gr√°fica, no longo prazo, seu uso pode se tornar um tanto quanto dif√≠cil. Isso porque √© praticamente imposs√≠vel memorizar a sequ√™ncia de √≠cones pressionados e itens escolhidos em caixas de di√°logo para realizar uma determinada tarefa pedom√©trica. Em geral, ser√° preciso anotar todos os passos em um arquivo separado, muitas vezes incluindo imagens da pr√≥pria interface gr√°fica e dos √≠cones pressionados. Se essa documenta√ß√£o n√£o for feita, voc√™ corre o risco de, depois de algum tempo, n√£o mais conseguir executar exatamente a mesma tarefa com seu conjunto de dados. Por exemplo, os revisores de um artigo que voc√™ submeteu para publica√ß√£o exigem que voc√™ refa√ßa um determinado passo de uma an√°lise estat√≠stica que voc√™ usou para produzir uma das tabelas do seu artigo: doze meses depois da submiss√£o, voc√™ j√° esqueceu, quase que completamente, como foi que voc√™ analisou aqueles dados. Esse problema √© comumente conhecido como o problema da [irreprodutibilidade][reprodutibilidade].

[reprodutibilidade]: https://pt.wikipedia.org/wiki/Reprodutibilidade

A **reprodutibilidade** √© uma caracter√≠stica de um experimento ou estudo. Ela correspondendo ao potencial que um experimento tem de ser reproduzido, tanto pelo mesmo pesquisador como por qualquer outro pesquisador trabalhando independentemente em qualquer lugar do planeta, constituindo um dos principais elementos do [ideal cient√≠fico][metodo-cientifico]. Logicamente, o problema da irreprodutibilidade de um estudo √© muito mais dif√≠cil de superar quando outro pesquisador deseja reproduzir o experimento pedom√©trico que voc√™ conduziu e vice-versa. Em geral, al√©m de uma extensiva descri√ß√£o do material e dos m√©todos usados em um estudo pedom√©trico, a reprodutibilidade s√≥ se torna um fato quando a totalidade do ambiente computacional usado para realizar o estudo est√° livremente dispon√≠vel. Grosso modo, isso inclui os dados -- veja mais no pr√≥ximo cap√≠tulo [Gest√£o de Dados] -- e a sequ√™ncia de comandos emitidos para comunica√ß√£o com o computador.

[metodo-cientifico]: https://pt.wikipedia.org/wiki/M%C3%A9todo_cient%C3%ADfico

A maneira mais eficiente de registrar a sequ√™ncia de comandos emitidos para comunica√ß√£o com o computador durante a realiza√ß√£o de uma tarefa pedom√©trica requer o uso, diretamente, da linguagem do programa de computador, ou seja, uma [linguagem de programa√ß√£o][linguagem-de-programacao]. Nesse caso, nossa comunica√ß√£o com o computador se d√° via uso de uma interface de linha de comando ([CLI][cli], do ingl√™s *command-line interface*), ou seja, via emiss√£o de comandos sob a forma de sucessivas linhas de texto, as chamadas linhas de comando. Sendo uma linguagem, toda linguagem de programa√ß√£o possui regras sint√°ticas e sem√¢nticas -- uma gram√°tica --, as quais devem ser estritamente respeitadas para que haja, efetivamente, comunica√ß√£o entre n√≥s e o computador. Dentre os programa de computador que veremos neste cap√≠tulo que usam uma interface de linha de comando, o principal deles √© o R.

[linguagem-de-programacao]: https://pt.wikipedia.org/wiki/Linguagem_de_programa%C3%A7%C3%A3o

[cli]: https://pt.wikipedia.org/wiki/Linha_de_comandos

Al√©m de potencializarem a reprodutibilidade, uma das grandes vantagens dos programas de computador que utilizam comandos de texto -- ao inv√©s de bot√µes e caixas de di√°logo -- √© o fato de permitirem ao usu√°rio fazer adapta√ß√µes metodol√≥gicas, desenvolver novos m√©todos e expandir sua caixa de ferramentas anal√≠ticas para al√©m daquilo que j√° estiver implementado no programa de computador. Por outro lado, a grande desvantagem desses programas de computador √© a maior dificuldade de aprendizagem e dom√≠nio do seu uso, geralmente necessitando grande esfor√ßo e persist√™ncia. Em outras palavras, diz-se que esses programas de computador possuem uma curva de aprendizagem -- uma representa√ß√£o gr√°fica da aprendizagem ao longo do tempo -- bastante inclinada, portanto dif√≠cil de superar (Figure \@ref(fig:curva-de-aprendizagem)).

```{r curva-de-aprendizagem, echo=FALSE, fig.cap="Curva de aprendizagem hipot√©tica de um programa de computador que utiliza comandos de texto e a produtividade relativa do usu√°rio ao longo do tempo."}
y0 <- 0.2
y <- c(rep(y0, 25), seq(y0, 0.1, -0.1), rep(0.01, 30), seq(0.1, y0 * 3, 0.1), rep(y0 * 3, 35))
x <- 1:length(y)
par(mgp = c(0, 1, 0), mar = rep(1, 4))
plot(y ~ x, type = "l", main = "Curva de aprendizagem", xlab = "Tempo empregado", 
     ylab = "Produtividade relativa", ylim = c(0, 1), axes = FALSE)
text(42, 0.1, "Vale da Morte", col = "red")
text(12, 0.25, "Antes")
text(80, 0.65, "Depois")
arrows(-1, -0.01, 100, -0.01, length = 0.1)
arrows(-1, -0.01, -1, 1, length = 0.1)
arrows(x[length(x)- 1], y[length(y)], x[length(x)], y[length(y)], length = 0.1)
```

Usando alguns programas de computador tradicionais, populares, voc√™ tem conseguido desenvolver estudos bastante interessantes. Contudo, por algum motivo, voc√™ decide aprender a usar outro programa de computador, um programa de computador baseado na emiss√£o de linhas de comando, a fim de aumentar sua produtividade e a qualidade de seus estudos. As primeiras experi√™ncias com o novo programa de computador ser√£o dif√≠ceis e voc√™ se sentir√° perdido, talvez desesperado. A tenta√ß√£o de abandonar aquele novo programa de computador aparecer√° logo, e voc√™ se sentir√° inclinado a voltar a usar apenas as mesmas ferramentas que usava antes. Talvez sua vontade "morra" ao longo do caminho. Contudo, voc√™ precisa resistir e acreditar que consegue vencer os perigos do Vale da Morte. Voc√™ precisa estar disposto a encarar a √≠ngreme curva de aprendizagem. Depois de passar por tudo isso, sua produtividade (ou capacidade produtiva) dever√° ser algumas ordens de magnitude maior do que antes de conhecer aquele novo programa de computador.

Note que a dificuldade na aprendizagem do uso de programas de computador baseados na emiss√£o de linhas de comando n√£o se deve √† uma dificuldade inerente √† esses programa de computador. Na verdade, nossa dificuldade adv√©m, principalmente, do fato de, em geral, sermos introduzidos primeiro, ainda na nossa inf√¢ncia, √† programa de computador que disp√µe apenas de interfaces gr√°ficas, com uma por√ß√£o de √≠cones e caixas de di√°logo -- veja, por exemplo, seu *smartphone*.

Nesse ponto voc√™ j√° deve ter percebido que para desenvolver estudos pedom√©tricos n√£o basta aprender e dominar o uso de diversos softwares. Tamb√©m √© preciso aprender e dominar (pelo menos) uma nova linguagem, um novo sistema de signos. Adianto que, em geral, algumas das regras gramaticais dessas linguagens podem ser deduzidas a partir daquilo que j√° sabemos em fun√ß√£o do uso de outros programas de computador de an√°lise e processamento de dados. Contudo, como qualquer linguagem de programa√ß√£o, existem especificidades, boa parte das quais √© preciso conhecer para termos sucesso em seu uso. Al√©m disso, algum conhecimento da l√≠ngua inglesa costuma ser necess√°rio, haja vista que as linguagens de programa√ß√£o costumam ser constru√≠das com base em palavras da l√≠ngua inglesa. A ideia aqui √© tentar fazer com que sua travessia pelo Vale da Morte seja a mais curta e menos dolorosa poss√≠vel.

## R & RStudio

O R √© uma linguagem de programa√ß√£o e um ambiente de an√°lises estat√≠sticas e gr√°ficas gratuito. Sua origem data de 1995, quando os pesquisadores [Robert Gentleman][robert-gentleman] e [Ross Ihaka][ross-ihaka] iniciaram o projeto de seu desenvolvimento no Departamento de Estat√≠stica da Universidade de Auckland na Nova Zel√¢ndia. Baseado na linguagem de programa√ß√£o e ambiente estat√≠stico [S][s], desenvolvido por [John Chambers][john-chambers] e colegas no [Bell Laboratories][bell-laboratories], o nome R deriva das iniciais dos dois pesquisadores (R), mas tamb√©m de uma brincadeira com o nome da linguagem e ambiente no qual foi baseado (S). Hoje o R √© um software livre mantido e desenvolvido pelo [R Core Team][r-core-team], dispon√≠vel gratuitamente para qualquer interessado em utiliz√°-lo, modific√°-lo e redistribu√≠-lo.

[bell-laboratories]: https://en.wikipedia.org/wiki/Bell_Labs
[ross-ihaka]: https://en.wikipedia.org/wiki/Ross_Ihaka
[robert-gentleman]: https://en.wikipedia.org/wiki/Robert_Gentleman_(statistician)
[s]: https://en.wikipedia.org/wiki/S_(programming_language)
[john-chambers]: https://en.wikipedia.org/wiki/John_Chambers_(statistician)
[r-core-team]: https://www.r-project.org/contributors.html

O R fornece uma ampla variedade de t√©cnicas estat√≠sticas, incluindo an√°lises univariadas, bivariadas e multivariadas, desde as mais simples at√© as mais complexas, como an√°lises descritivas, an√°lise de vari√¢ncia e testes de m√©dias, an√°lise de agrupamento e de componentes principais, an√°lise de s√©ries temporais, modelagem geoestat√≠sticas e muito, muito mais. O R ainda fornece uma s√©rie de ferramentas para produ√ß√£o de diversos tipos gr√°ficos com qualidade para publica√ß√£o. Todas essas t√©cnicas e ferramentas, al√©m de amplamente documentadas, s√£o customiz√°veis e extens√≠veis. Assim, al√©m de dispor das t√©cnicas j√° inclu√≠das no ambiente R, o usu√°rio pode utilizar-se da linguagem R para criar suas pr√≥prias t√©cnicas e, em seguida, torn√°-las dispon√≠veis para uso pela comunidade cient√≠fica na forma de pacotes.

A grande vantagem do R em rela√ß√£o aos demais programas de computador existentes para an√°lises estat√≠sticas e gr√°ficas √© o fato de ele aliar o enorme volume de t√©cnicas de an√°lise estat√≠stica e gr√°fica √† completa gratuidade. Ao contr√°rio do que alguns possam pensar, essa gratuidade n√£o √© sin√¥nimo de baixa qualidade. Pelo contr√°rio, √© a gratuidade que permite que milhares de cientistas ao redor do mundo usem e verifiquem a qualidade dessas t√©cnicas. S√£o esses mesmos cientistas que ajudam a desenvolver o R mais e mais, disponibilizando grande parte de seu tempo de trabalho para elaborar a mir√≠ade de tutoriais e materiais de apoio para o R dispon√≠veis atualmente -- nenhum programa de computador comercial possui, seja em meio digital ou em meio impresso, um volume de material de apoio maior do que o R. Ao tornar-se uma linguagem comum entre os cientistas, o R ainda permite que o registro das rotinas anal√≠ticas possa ser compartilhado e, quando necess√°rio, verificado ou disponibilizado para verifica√ß√£o por outros cientistas, possibilitando a observa√ß√£o daquele que vimos ser um dos principais ideias do m√©todo cient√≠fico: a reprodutibilidade.

Em resumo, o R √© completamente gratuito, pode ser usado para conduzir qualquer tipo de an√°lise estat√≠stica e gr√°fica, √© amplamente documentado, customiz√°vel e extens√≠vel, permite o compartilhamento e reprodu√ß√£o de rotinas anal√≠ticas, sendo uma linguagem comum entre cientistas de diferentes partes do mundo. Ser√° que √© preciso dizer mais alguma coisa?!

<!-- Depois de instalar o R, agora √© a hora de escolher uma [GUI][gui] que facilite nossa intera√ß√£o com o R. Isso porque  -->
<!-- o R possui apenas uma  -->
<!-- interface para emiss√£o de linhas de comando de texto, tamb√©m chamado ***console***. Dentre as diversas op√ß√µes -->
<!-- gratuitamente dispon√≠veis, as -->
<!-- mais atrativas s√£o aquelas que incluem ferramentas adicionais de apoio √† programa√ß√£o em R e facilitem a -->
<!-- an√°lise, visualiza√ß√£o e gerenciamento dos dados. Tais ferramentas constituem os chamados ambientes de -->
<!-- desenvolvimento integrado ([IDE][ide], do ingl√™s *integrated development environment*). Atualmente, a GUI e  -->
<!-- IDE mais popular √© o -->

<!-- [ide]: https://en.wikipedia.org/wiki/Integrated_development_environment -->

### Instala√ß√£o

Passemos agora √† instala√ß√£o do R em seu computador. Para isso precisamos, primeiro, visitar a p√°gina do projeto na Internet (Figura \@ref(fig:r-project-page)).

```{r r-project-page, echo=FALSE, fig.cap="Janela de acesso √† p√°gina inicial do projeto R na Internet."}
knitr::include_url("http://www.r-project.org/")
```

Veja que uma grande quantidade de informa√ß√£o, muito al√©m do que se busca incluir neste cap√≠tulo, pode ser encontrada na p√°gina do projeto. Ali est√£o dispon√≠veis diversos manuais de uso (`Documentation > Munuals`), bem como livros (`Documentation > Books`) e artigos publicados na revista do projeto (`Documentation > The R Journal`). H√° ainda uma p√°gina com respostas √†s perguntas mais frequentes (`Documentation > FAQs`) e uma p√°gina inteira explicando como √© poss√≠vel conseguir ajuda antes de recorrer diretamente a terceiros (`Help With R > Getting Help`). (Como a documenta√ß√£o do R √© extensa e a maioria dos colaboradores do projeto n√£o s√£o pagos pela colabora√ß√£o, recomendo que voc√™ sempre procure, primeiro, resolver qualquer d√∫vida sozinho üòÉ)

O procedimento de instala√ß√£o do R depende do sistema operacional ([OS][os], do ingl√™s *operating system*) de seu computador:

[os]: https://en.wikipedia.org/wiki/Operating_system

* Linux: https://cloud.r-project.org/bin/linux/
* (Mac) OS X: https://cloud.r-project.org/bin/macosx/
* Windows: https://cloud.r-project.org/bin/windows/base/

A p√°gina referente √† cada OS possui as instru√ß√µes necess√°rias para descarregar e instalar o R em seu computador. Em geral, o processo de instala√ß√£o √© exatamente igual aquele de outros programas de computador que voc√™ usa em seu dia-a-dia. (Caso o R apresente problemas de funcionamento ap√≥s a instala√ß√£o, tente descarregar e instalar a vers√£o anterior üòÉ)

Instalado o R, agora √© a hora de instalar o RStudio. A √∫ltima vers√£o do instalador do RStudio para o seu OS pode ser descarregada do seguinte endere√ßo:

* https://www.rstudio.com/products/rstudio/download/

Caso voc√™ queira instalar a mais nova vers√£o do RStudio, ainda em est√°gio de teste, ent√£o descarregue o instalador do seguinte endere√ßo:

* https://www.rstudio.com/products/rstudio/download/preview/

Depois de instalados o R e o RStudio, inicie o RStudio em seu computador. Ele deve se parecer mais ou menos como na figura a seguir:

![RStudio -- ambiente de desenvolvimento integrado para R (em sua vers√£o para Linux).](images/rstudio-snapshot.png)

Voc√™ deve ter notado que o RStudio √© composto por quatro grandes pain√©is retangulares, cada um contendo conte√∫do espec√≠fico. Grosso modo, o painel superior direito mostra informa√ß√µes diversas sobre a atual sess√£o de trabalho, sendo geralmente pouco utilizado. J√° o painel inferior direito serve √† visualiza√ß√£o de gr√°ficos e p√°ginas de ajuda do R, o que o faz ser bastante utilizado. O painel superior esquerdo √© aquele utilizado para a programa√ß√£o em R, ou seja, aquele onde as linhas de comando utilizadas para a an√°lise dos dados s√£o editadas. Esse painel √© aquele onde creio que ocupamos a maior parte do tempo. Por fim, o painel inferior esquerdo corresponde √† interface de linha de comando (CLI), o **console** do R. √â ali que as linhas de comando editadas no painel superior esquerdo deve ser emitidas para que a "m√°gica" aconte√ßa. Para isso voc√™ pode, no editor, posicionar o cursor sobre a linha de c√≥digo fonte que deseja que seja emitida e pressionar, simultaneamente, as teclas `Ctrl` e `Enter`. Alternativamente, para emitir um bloco de linhas de comando, voc√™ deve selecion√°-lo por completo e ent√£o pressionar as teclas `Ctrl` e `Enter`.

### Primeiros passos

Agora √© a hora de efetivamente interagir com o R. Fa√ßamos logo algumas opera√ß√µes matem√°ticas para nos familiarizarmos com ele. Voc√™ pode copiar e colar as linhas de comando abaixo no console do R.

```{r}
# As quatro opera√ß√µes matem√°ticas b√°sicas:
2+3   # soma
5 * 5 # multiplica√ß√£o
25/5  # divis√£o 
5 - 3 # subtra√ß√£o

# Tr√™s opera√ß√µes matem√°ticas √∫teis:
2^2          # Potencia√ß√£o (ou exponencia√ß√£o)
log(x = 4)   # Fun√ß√£o logar√≠tmica
sqrt(x = 25) # Raiz quadrada
```

Voc√™ deve ter notado que que os s√≠mbolos utilizados (`+`, `*`, `/` e `-`) s√£o os mesmos encontrados em qualquer calculadora cient√≠fica. S√£o tamb√©m os mesmos utilizados nas opera√ß√µes matem√°ticas de qualquer planilha eletr√¥nica de edi√ß√£o de dados. Isso significa que podemos deduzir algumas coisas sobre o funcionamento do R a partir daquilo que conhecemos de outros programas de computador dedicados √† an√°lise e manipula√ß√£o de dados. Voc√™ tamb√©m deve ter observado que o espa√ßamento entre n√∫mero e operador matem√°tico n√£o tem qualquer import√¢ncia do ponto de vista da opera√ß√£o matem√°tica. Contudo, do ponto de vista est√©tico -- para facilidade de leitura do c√≥digo fonte por humanos --, costuma-se usar a formata√ß√£o com espa√ßos `2 + 3` ao inv√©s de `2+3`. (A exce√ß√£o √© a opera√ß√£o de divis√£o, geralmente expressa na forma sem espa√ßos `2/3` üòÉ)

Outro detalhe importante nas linhas de comando acima √© o uso do s√≠mbolo `#` para a inclus√£o de pequenos coment√°rios sobre os comandos. Os coment√°rios podem ser inclu√≠dos tanto em uma linha pr√≥pria como na mesma linha ap√≥s um comando -- mas nunca antes de um comando. A inclus√£o de pequenos coment√°rios no c√≥digo fonte √© fundamental para documentarmos os detalhes da atividade que estamos realizando a fim de que outros -- e n√≥s mesmos, algumas semanas ou meses mais tarde -- possamos entender o prop√≥sito de cada uma daquelas linhas de comando.

Finalmente, voc√™ deve ter notado que as duas √∫ltimas opera√ß√µes matem√°ticas foram feitas usando um identificador -- especificamente, uma "palavra" -- seguido por dois par√™nteses contendo um valor num√©rico atribu√≠do ao argumento `x`: `log(x = 4)` e `sqrt(x = 25)`. Aqui, `log()` e `sqrt()` s√£o ***fun√ß√µes*** do R, nesse caso as fun√ß√µes logar√≠tmica e raiz quadrada, assim como `sum()` (soma), `diff()` (diferen√ßa), `prod()` (produto), entre outras. No R, uma fun√ß√£o arbitr√°ria chamada `fun()` sempre √© usada da seguinte maneira: `fun(x)`, onde `x` √© um argumento qualquer (um n√∫mero, por exemplo) tomado pela fun√ß√£o para realizar uma determinada opera√ß√£o. Como exemplo final, tomemos uma fun√ß√£o bastante conhecida entre cientistas do solo, a fun√ß√£o que que representa a Lei B√°sica da Ci√™ncia do Solo,

$$solo = f(cl, o, r, p, t, \ldots)$$

onde $cl$ representa o clima, $o$ representa os organismos vivos, incluindo n√≥s seres humanos, $r$ significa relevo, $p$ √© o material parental, $t$ representa o tempo e $\ldots$ s√£o fatores n√£o conhecidos ou de limitada relev√¢ncia. Em R, essa fun√ß√£o seria escrita exatamente da mesma forma: `solo = f(cl, o, r, p, t, ...)`. Vejamos mais um exemplo, agora de uma fun√ß√£o que aceita v√°rios argumentos:

```{r}
plot(x = 25, y = 25, col = "red", main = "Um ponto vermelho", xlab = "x", ylab = "y")
```

### Conceitos b√°sicos

Passada a primeira impress√£o, agora precisamos nos familiarizar com alguns conceitos b√°sicos para que 
possamos entender o R e utiliz√°-lo com √™xito. Conforme destacado acima, o R n√£o √© um simples programa de computador para
an√°lises estat√≠sticas, mas sim um ambiente de programa√ß√£o. E, para isso, precisamos de uma linguagem de 
programa√ß√£o, ou seja, a linguagem de programa√ß√£o R.

A gram√°tica da linguagem de programa√ß√£o R possui dois elementos principais: as palavras reservadas
e as palavras-chave. As ***palavras reservadas*** constituem signos com significado especial para a linguagem
de programa√ß√£o, definidas internamente no c√≥digo fonte, e que n√£o podem ser utilizadas pelo usu√°rio para fins 
outros que n√£o aqueles especificados internamente pelo programa de computador (por exemplo, para identificar objetos e
fun√ß√µes -- veremos esses conceitos a seguir). Algumas das palavras reservadas do R s√£o `if`, `else`, `while`,
`TRUE` e `FALSE`. Note que no editor de c√≥digo fonte do RStudio as palavras reservadas aparecem sempre
destacadas em azul -- busque pelo termo *reserved* no painel de ajuda do RStudio (painel inferior direito) 
para conhecer as palavras reservadas do R.

As ***palavras-chave*** s√£o aquelas utilizadas para definir fun√ß√µes (e objetos, como veremos a seguir). As
palavras-chave que definem fun√ß√µes s√£o aquelas que acionam opera√ß√µes matem√°ticas e l√≥gicas que possibilitam, 
por exemplo, a realiza√ß√£o de uma determinada an√°lise estat√≠stica de um determinado conjunto de dados -- na 
verdade, tudo o que "acontece" no R acontece pela a√ß√£o de uma fun√ß√£o. As palavras-chave que definem fun√ß√µes
podem j√° estar definidas na pr√≥pria linguagem de programa√ß√£o -- como `log`, `sqrt` e `plot` nos exemplos acima
-- ou ser criadas pelo usu√°rio. Isso significa que o usu√°rio pode criar suas pr√≥prias fun√ß√µes no R conforme 
sua necessidade. Vejamos um exemplo:

```{r}
# A palavra-chave 'soma' √© usada para definir uma fun√ß√£o que computa
# e retorna como resultado `res` a soma de dois valores num√©ricos.
# A estrutura de uma fun√ß√£o aparece, sempre, entre '{' e '}'.
soma <- 
  function (x, y) { 
    res <- x + y
    return (res)
    }
soma(x = 2, y = 2)
```

Voc√™ deve ter notado que duas palavras reservadas foram usadas na constru√ß√£o da fun√ß√£o `soma()`. S√£o elas:
`function` e `return`. Al√©m disso, uma segunda palavra-chave foi usada: `res`. Essa palavra-chave foi usada
para definir um objeto que armazena o resultado da opera√ß√£o matem√°tica realizada usando o s√≠mbolo `+`. Assim, 
na verdade, a fun√ß√£o `soma()` n√£o retorna o resultado da opera√ß√£o matem√°tica, mas sim um objeto que armazena
o seu resultado. Grosso modo, um ***objeto*** nada mais √© do que uma estrutura de dados -- como diria John
Chambers, tudo o que "existe" no R √© um objeto. Essas estruturas de dados s√£o vetores, matrizes, listas e 
outras estruturas de dados inseridas ou criadas pelo pr√≥prio usu√°rio ou produzidas como resultado dos diversos 
procedimentos anal√≠ticos. Vejamos alguns exemplos para nos familiarizamos com o conceito de objeto.

Imagine dois vetores de dados $x = [1, 2, 3, 4, 5]$ e $y = [2, 4, 3, 5, 7]$. Esses vetores s√£o inseridos 
no R e nomeados, respectivamente, como `x` e `y`. Ent√£o, `x` e `y` passam a ser palavras-chave que identificam
dois objetos, ou seja, uma estrutura de dados, nesse caso, vetores. Ao emitirmos uma chamada dos objetos 
`x` e `y`, o R retorna os respectivos valores neles armazenados:

```{r}
# Definindo dois objetos vetoriais
# Note que quando criamos uma sequ√™ncia ordenada de valores podemos 
# simplesmente usar o s√≠mbolo ':' entre o menor e o maior valor da 
# sequ√™ncia ao inv√©s de declarar todos os seus valores.
x <- 1:5
y <- c(2, 4, 3, 5, 7)
x
y
```

Suponha agora que estamos interessados na constru√ß√£o de um modelo de regress√£o linear, para a qual usamos a
fun√ß√£o `lm()` (do ingl√™s *linear model*), do vetor $y$ em fun√ß√£o do vetor $x$:

```{r}
# Calibra√ß√£o de um modelo de regress√£o linear
# Note que √© poss√≠vel usar simbolos como '.' e '_' na constru√ß√£o de 
# uma palavra-chave identificadora de objeto (ou fun√ß√£o).
meu.modelo_linear <- lm(y ~ x)
meu.modelo_linear
```

Nesse exemplo, o objeto identificado pela palavra-chave `meu.modelo_linear` constitui uma estrutura de dados
que cont√©m todas as especifica√ß√µes do modelo de regress√£o linear de $y$ em fun√ß√£o de $x$. Ao emitirmos uma 
chamada ao objeto `meu.modelo_linear` o R retorna os coeficientes do modelo de regress√£o linear calibrado. Se
voc√™ quiser conhecer mais sobre a estrutura do objeto `meu.modelo_linear`, use o seguinte comando: 
`str(meu.modelo_linear)`. Como sugest√£o, use tamb√©m os comandos `anova(meu.modelo_linear)`,
`summary(meu.modelo_linear)` e `plot(meu.modelo_linear)`.

Voc√™ deve ter notado nos exemplos acima que a atribui√ß√£o de uma palavra-chave √† um objeto ou √† uma fun√ß√£o 
est√° sempre atrelada ao uso do s√≠mbolo `<-`. Por exemplo, `x <- 1:5` atribui a palavra-chave `x` ao objeto
de estrutura vetorial contendo valores num√©ricos de 1 at√© 5. A atribui√ß√£o tamb√©m pode ser feita usando o 
s√≠mbolo `=`. Contudo, como `=` tamb√©m pode ser usado em contextos outros que n√£o a atribui√ß√£o de 
palavras-chave, o uso de `<-` costuma ser preferido.

### Os pacotes

A instala√ß√£o b√°sica do R oferece uma s√©rie de ferramentas para an√°lises estat√≠sticas e gr√°ficas. Essas 
ferramentas s√£o organizadas em pacotes. Um ***pacote*** constitui uma cole√ß√£o de arquivos e diret√≥rios que
cont√©m as regras sint√°ticas e sem√¢nticas que definem determinadas opera√ß√µes matem√°ticas e l√≥gicas. Cada pacote
possui um nome espec√≠fico e ficam armazenados no diret√≥rio de instala√ß√£o do R. S√£o exemplos os pacotes `base` 
e `stats`.

Conforme dito acima, o R oferece uma infinidade de ferramentas para an√°lises estat√≠sticas e gr√°ficas
desenvolvidas por cientistas ao redor de todo o mundo. Contudo, essas ferramentas n√£o est√£o dispon√≠veis na
instala√ß√£o b√°sica do R. Para ter acesso a essas ferramentas voc√™ precisa instalar novos pacotes, ou seja, 
novas cole√ß√µes de arquivos e diret√≥rios que cont√©m regras sint√°ticas e sem√¢nticas que definem opera√ß√µes
matem√°ticas e l√≥gicas. No caso da an√°lise de dados espaciais (geogr√°ficos), o pacote mais importante √© o `sp`.
Para an√°lises geoestat√≠sticas temos, entre outros, os pacotes `gstat` e `geoR`. J√° os pacotes `spcosa` e
`spsann` prestam-se √† amostragem espacial. A seguir voc√™ tem uma vis√£o da lista de pacotes dispon√≠veis para 
o R.

```{r, echo=FALSE}
knitr::include_url("https://cloud.r-project.org/web/packages/available_packages_by_name.html")
```

Existem duas maneiras principais para instalar um novo pacote. Primeiro, voc√™ pode ir at√© o painel inferior
direito do RStudio e escolher `Packages > Install`. Na caixa de di√°logo que aparecer√°, voc√™ insere o nome do
pacote que quiser instalar -- voc√™ tamb√©m pode inserir o nome de v√°rios pacotes separados por um espa√ßo. 
Definido o pacote, basta pressionar `Install`. A outra maneira √© usando uma linha de comando como segue:

```{r, eval=FALSE}
# Instalando novos pacotes no R.
# Procure na ajuda da fun√ß√£o 'install.packages' pelo significado
# do argumento 'dependencies'.
install.packages(
  c("sp", "raster", "rgdal", "pedometrics", "randomForest", "rsaga"), dependencies = TRUE)
```

Pronto! Agora voc√™ ter√° a sua disposi√ß√£o tamb√©m as funcionalidades inclu√≠das nesses pacotes.

### Ferramentas avan√ßadas

#### Tidyverse

O [tidyverse][tidyverse] √© uma cole√ß√£o de pacotes desenvolvidos principalmente pela equipe do RStudio. Esses pacotes visam fornecer as ferramentas necess√°rias para realizar a maioria das tarefas b√°sicas executadas no processo de an√°lise de dados (leitura, limpeza, manipula√ß√£o e exporta√ß√£o de dados, produ√ß√£o de gr√°ficos, entre outros).

[tidyverse]: https://www.tidyverse.org/

#### Operador `%>%`

Uma das contribui√ß√µes mais √∫teis do `titidyverseo operador `%>%`, chamado _pipe_ (tubo ou cano), provido pelo
pacote [magmagrittragrittr]. Um _pipe_ estabelece uma comunica√ß√£o direta entre dois procesos,s representando 
assim algo que possui uma "entrada", um "caminho" e uma "sa√≠da". Essa "entrada" representa, por exemplo, o 
produto de uma fun√ß√£o qualquer, o qual √© encaminhado diretamente, sem a necessidade de "paradas", pelo operador
`%>%`, para uma segunda fun√ß√£o, que ent√£o produz um produto final na "sa√≠da". Vejamos um exemplo para que voc√™
entenda a utilidade do _pipe_.

[magrittr]: https://github.com/tidyverse/magrittr

Suponha que voc√™ queira fazer uma sequ√™ncia de opera√ß√µes. Uma forma comum √© definir, para cada opera√ß√£o, um 
objeto tempor√°rio, at√© que o produto final da sequ√™ncia de opera√ß√µes seja obtido. Por exemplo:

```{r}
# Sequ√™ncia de opera√ß√µes usando objetos tempor√°rios
x <- exp(25)
y <- sqrt(x)
z <- log(y)
z
rm(x, y)
gc()
```

O problema dessa estrat√©gia √© que ela √© muito verbosa, ou seja, ela requer muitas linhas de comando. No exemplo
usado, apesar das opera√ß√µes serem bastante simples, foram necess√°rias seis linhas de comando. Uma alternativa √©
usar fun√ß√µes aninhadas, que elimina a necessidade de cria√ß√£o de objetos tempor√°rios. Dependendo do tamanho do
conjunto de dados, esses objetos tempor√°rios podem consumir toda a RAM dispon√≠vel em seu computador durante a
execu√ß√£o da sequ√™ncia de opera√ß√µes. Al√©m disso, voc√™ pode acabar esquecendo de remov√™-los do ambiente de 
trabalho e assim permitir que eles indesejadamente afetem outras opera√ß√µes. Vejamos um exemplo:

```{r}
# Sequ√™ncia de opera√ß√µes usando fun√ß√µes aninhadas
z <- log(sqrt(exp(25)))
z
```

Note que agora apenas duas linhas de comando foram necess√°rias para executar a mesma sequ√™ncia de opera√ß√µes.
Contudo, um novo problema foi criado, o da legibilidade das linhas de comando. Como nossa tradi√ß√£o de leitura
segue de cima para baixo e da esquerda para a direita, temos grande facilidade de ler e entender qual √© a
sequ√™ncia de opera√ß√µes realizada no primeira exemplo. J√° no segundo exemplo, precisamos realizar a leitura da
do 
c√≥digo da eita para a esquerda ou ent√£o pensar de maneira reversa. √â claro que isso √© f√°cil de se fazer com o e
o exemplo ma. Contudo, √† medida que aumenta a complexidade da sequ√™ncia de opera√ß√µes e das fun√ß√µes uti
utilizadas, mais √≠cil fica de ler/decifrar um conjunto de fun√ß√µes aninhadas.

O operador `%>%` resolve todos esses problemas de uma vezs√≥  s√≥ u atalho √© `Ctrl + Shift + M`):

```{r, echo=FALSE}
library(magrittr)
```

```{r}
# Sequ√™ncia de opera√ß√µes usando os operadores %>% e %T>%
z <- exp(25) %>% sqrt() %>% log() %T>% print()
```

Veja como a leitura da linha de comando ficou bem mais f√°cil -- como quando usamos objetos tempor√°rios -- e 
pouqu√≠ssimo verbosa -- como quando usamos fun√ß√µes aninhadas. Assim, o _pipe_ colabora para a produ√ß√£o de c√≥digo
fonte letrado, ou seja, leg√≠vel e compreens√≠vel n√£o apenas por m√°quinas, mas principalmente por seres humanos.

#### Visualiza√ß√£o interativa de objetos espaciais

Pacote [mapview][mapview].

[mapview]: https://r-spatial.github.io/mapview/

```{r, eval=FALSE}
# Instala√ß√£o da vers√£o mais recente do pacote mapview
devtools::install_github("r-spatial/mapview", dependencies = TRUE)
```

### Lembrete final

Conforme vimos acima, todas as funcionalidades do R s√£o acionadas pelo uso de comandos de texto e
s√≠mbolos (matem√°ticos ou n√£o). A maioria desses comandos e s√≠mbolos j√° est√£o definidos na linguagem do R e, 
por isso, quando utilizados, devem ser inseridos de maneira correta para que sejam efetivamente reconhecidos.
Assim, √© importante ter muito cuidado durante a edi√ß√£o do c√≥digo fonte. Tome cuidado, por exemplo, com a 
sensibilidade do R ao uso de letras mai√∫sculas e min√∫sculas. E evite, sempre, o uso de acentua√ß√£o e cedilha 
em palavras-chave para nomear objetos e fun√ß√µes.

Se voc√™ emitir um comando e o mesmo estiver sintaticamente incompleto, o console mostrar√° o s√≠mbolo `+`, 
indicando que h√° algo faltando. Note que esse aviso n√£o √© uma mensagem de erro, ou seja, n√£o h√° necessidade de
reescrever o comando, mas apenas completar o que falta. Mas se o comando possuir erros sint√°ticos, os mesmos
ser√£o identificados pelo RStudio ainda no editor do c√≥digo fonte, mostrando um s√≠mbolo vermelho ao lado da
linha na qual √© mais prov√°vel que o erro se encontra.

Como o dom√≠nio do uso do R depende da memoriza√ß√£o, pelo menos parcial, dos nomes das fun√ß√µes e seus argumentos,
sugiro que voc√™ sempre tenha √† m√£o algum cart√£o de refer√™ncia. Abaixo voc√™ pode encontrar quatro deles
produzidos por diferentes usu√°rios do R:

* [Jonathan Baron](http://www.psych.upenn.edu/~baron/refcard.pdf)
* [Tom Short](https://cloud.r-project.org/doc/contrib/Short-refcard.pdf)
* [Vito Ricci](https://cran.r-project.org/doc/contrib/Ricci-refcard-regression.pdf)
* [Yanchang Zhao](https://cran.r-project.org/doc/contrib/YanchangZhao-refcard-data-mining.pdf)

## QGIS 

http://www.qgis.org/

## SAGA GIS

http://www.saga-gis.org/

## GRASS GIS

https://grass.osgeo.org/

## GDAL/OGR

http://www.gdal.org/


<!-- # Gest√£o de Dados e C√≥digo Fonte -->
